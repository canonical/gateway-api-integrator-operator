[32mINFO    [0m pytest_operator.plugin:plugin.py:806 Connecting to existing model github-pr-a99c7-k8s:testing on unspecified cloud
[32mINFO    [0m juju.model:model.py:2098 Deploying local:gateway-api-integrator-0
[32mINFO    [0m juju.model:model.py:2972 Waiting for model:
  gateway-api-integrator/0 [allocating] waiting: installing agent
[32mINFO    [0m juju.model:model.py:2972 Waiting for model:
  gateway-api-integrator/0 [idle] blocked: Gateway class must be one of: [cilium,ck-gateway]
[32mINFO    [0m juju.model:model.py:2098 Deploying ch:amd64/jammy/self-signed-certificates-388
[32mINFO    [0m juju.model:model.py:2972 Waiting for model:
  self-signed-certificates/0 [allocating] waiting: installing agent
[32mINFO    [0m juju.model:model.py:2972 Waiting for model:
  self-signed-certificates/0 [idle] active: 
[33mWARNING [0m juju.model:model.py:1564 relate is deprecated and will be removed. Use integrate instead.
[32mINFO    [0m juju.model:model.py:2972 Waiting for model:
  self-signed-certificates/0 [idle] active: 
[32mINFO    [0m juju.model:model.py:2972 Waiting for model:
  self-signed-certificates/0 [idle] active: 
[32mINFO    [0m juju.model:model.py:2972 Waiting for model:
  gateway-api-integrator/0 [idle] blocked: Ingress integration not ready.
[32mINFO    [0m juju.model:model.py:2098 Deploying ch:amd64/jammy/flask-k8s-19
[33mWARNING [0m juju.model:model.py:1564 relate is deprecated and will be removed. Use integrate instead.
[32mINFO    [0m juju.model:model.py:2972 Waiting for model:
  flask-k8s/0 [allocating] waiting: installing agent
  gateway-api-integrator/0 [idle] blocked: Ingress integration not ready.
[32mINFO    [0m juju.model:model.py:2972 Waiting for model:
  flask-k8s/0 [idle] active: 
  gateway-api-integrator/0 [idle] active: Gateway addresses: 10.151.33.100
[32mINFO    [0m httpx:_client.py:1025 HTTP Request: GET https://10.151.33.224:6443/apis/gateway.networking.k8s.io/v1/namespaces/testing/gateways/gateway-api-integrator "HTTP/1.1 200 OK"
[32mINFO    [0m pytest_operator.plugin:plugin.py:951 Model status:

Model    Controller           Cloud/Region  Version  SLA          Timestamp
testing  github-pr-a99c7-k8s  k8s           3.5.7    unsupported  06:41:33Z

App                       Version  Status  Scale  Charm                     Channel      Rev  Address         Exposed  Message
flask-k8s                          active      1  flask-k8s                 latest/edge   19  10.152.183.113  no       
gateway-api-integrator             active      1  gateway-api-integrator                   0  10.152.183.81   no       Gateway addresses: 10.151.33.100
self-signed-certificates           active      1  self-signed-certificates  latest/edge  388  10.152.183.129  no       

Unit                         Workload  Agent  Address     Ports  Message
flask-k8s/0*                 active    idle   10.1.0.220         
gateway-api-integrator/0*    active    idle   10.1.0.20          Gateway addresses: 10.151.33.100
self-signed-certificates/0*  active    idle   10.1.0.133         

[32mINFO    [0m pytest_operator.plugin:plugin.py:957 Juju error logs:

unit-gateway-api-integrator-0: 06:38:38 ERROR unit.gateway-api-integrator/0.juju-log Configured gateway class  not present on the cluster.Available ones are: 'cilium,ck-gateway'
unit-gateway-api-integrator-0: 06:38:38 ERROR unit.gateway-api-integrator/0.juju-log Error setting up charm state component: Gateway class must be one of: [cilium,ck-gateway]
Traceback (most recent call last):
  File "/var/lib/juju/agents/unit-gateway-api-integrator-0/charm/src/state/validation.py", line 67, in wrapper
    return method(instance, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/var/lib/juju/agents/unit-gateway-api-integrator-0/charm/./src/charm.py", line 128, in _on_config_changed
    config = CharmConfig.from_charm(self, client)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/var/lib/juju/agents/unit-gateway-api-integrator-0/charm/src/resource_manager/permission.py", line 47, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/var/lib/juju/agents/unit-gateway-api-integrator-0/charm/src/state/config.py", line 89, in from_charm
    raise InvalidCharmConfigError(
state.config.InvalidCharmConfigError: Gateway class must be one of: [cilium,ck-gateway]
unit-gateway-api-integrator-0: 06:38:39 ERROR unit.gateway-api-integrator/0.juju-log Configured gateway class  not present on the cluster.Available ones are: 'cilium,ck-gateway'
unit-gateway-api-integrator-0: 06:38:39 ERROR unit.gateway-api-integrator/0.juju-log Error setting up charm state component: Gateway class must be one of: [cilium,ck-gateway]
Traceback (most recent call last):
  File "/var/lib/juju/agents/unit-gateway-api-integrator-0/charm/src/state/validation.py", line 67, in wrapper
    return method(instance, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/var/lib/juju/agents/unit-gateway-api-integrator-0/charm/./src/charm.py", line 141, in _on_start
    self._reconcile()
  File "/var/lib/juju/agents/unit-gateway-api-integrator-0/charm/./src/charm.py", line 266, in _reconcile
    config = CharmConfig.from_charm(self, client)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/var/lib/juju/agents/unit-gateway-api-integrator-0/charm/src/resource_manager/permission.py", line 47, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/var/lib/juju/agents/unit-gateway-api-integrator-0/charm/src/state/config.py", line 89, in from_charm
    raise InvalidCharmConfigError(
state.config.InvalidCharmConfigError: Gateway class must be one of: [cilium,ck-gateway]
unit-gateway-api-integrator-0: 06:39:32 ERROR unit.gateway-api-integrator/0.juju-log Error setting up charm state component: Certificates integration not ready.
Traceback (most recent call last):
  File "/var/lib/juju/agents/unit-gateway-api-integrator-0/charm/src/state/validation.py", line 67, in wrapper
    return method(instance, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/var/lib/juju/agents/unit-gateway-api-integrator-0/charm/./src/charm.py", line 136, in _on_config_changed
    self._reconcile()
  File "/var/lib/juju/agents/unit-gateway-api-integrator-0/charm/./src/charm.py", line 268, in _reconcile
    tls_information = TLSInformation.from_charm(self, self.certificates)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/var/lib/juju/agents/unit-gateway-api-integrator-0/charm/src/state/tls.py", line 49, in from_charm
    cls.validate(charm)
  File "/var/lib/juju/agents/unit-gateway-api-integrator-0/charm/src/state/tls.py", line 85, in validate
    raise TlsIntegrationMissingError("Certificates integration not ready.")
state.tls.TlsIntegrationMissingError: Certificates integration not ready.
unit-gateway-api-integrator-0: 06:39:36 ERROR unit.gateway-api-integrator/0.juju-log certificates:0: Error setting up charm state component: Ingress integration not ready.
Traceback (most recent call last):
  File "/var/lib/juju/agents/unit-gateway-api-integrator-0/charm/src/state/validation.py", line 67, in wrapper
    return method(instance, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/var/lib/juju/agents/unit-gateway-api-integrator-0/charm/./src/charm.py", line 191, in _on_certificate_available
    self._reconcile()
  File "/var/lib/juju/agents/unit-gateway-api-integrator-0/charm/./src/charm.py", line 278, in _reconcile
    self._define_ingress_resources_and_publish_url(
  File "/var/lib/juju/agents/unit-gateway-api-integrator-0/charm/./src/charm.py", line 388, in _define_ingress_resources_and_publish_url
    http_route_resource_information = HTTPRouteResourceInformation.from_charm(
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/var/lib/juju/agents/unit-gateway-api-integrator-0/charm/src/state/http_route.py", line 64, in from_charm
    raise IngressIntegrationMissingError("Ingress integration not ready.")
state.http_route.IngressIntegrationMissingError: Ingress integration not ready.

[32mINFO    [0m pytest_operator.plugin:plugin.py:1039 Forgetting model main...